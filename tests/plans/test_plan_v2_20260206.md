# Test Plan - 2026/02/06 (V2 Architecture)

## Objective
To verify the new architectural changes including parallel AI processing, overhauled history management (pending items support), and multi-channel notifications (Email + Telegram).

## Scope
### Unit Tests
- **Parser (`src/parser.py`)**: 
    - History migration from V1 (float) to V2 (dict).
    - Pending items retention and sorting.
    - `mark_as_processed` logic (removing content to save space).
    - SSL-bypass and custom headers for fetching.
- **AI Hub (`src/ai_hub.py`)**:
    - Concurrency control via Semaphore.
    - Quota exception handling (`429` / `RESOURCE_EXHAUSTED`).
    - Parallel execution return values.
- **Notifier (`src/notifier.py`)**:
    - `EmailNotifier`: Support for standby (no new articles) messages and warnings.
    - `TelegramNotifier`: Support for long message splitting and HTML formatting.
    - `send_all_reports`: Coordination between multiple channels.

## Execution Environment
- **Runtime**: Python 3.13
- **Venv**: `.venv`
- **Framework**: pytest (asyncio mode)

## Verification Steps
1. Run `./.venv/bin/pytest`.
2. Generate comprehensive markdown and HTML reports.
3. Manually verify directory structure in `tests/plans/` and `reports/`.
